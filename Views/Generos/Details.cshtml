@model AE4_DWES_CarlosdeAldaGarcia.Models.Genero

@{
    ViewData["Title"] = Model.Nombre;
}

<style>
  .details-breadcrumb {
     background: rgba(31, 31, 31, 0.6);
        padding: 1rem 1.5rem;
        border-radius: 10px;
        margin-bottom: 2rem;
    }

    .genre-header {
     background: linear-gradient(135deg, rgba(229, 9, 20, 0.9), rgba(178, 7, 16, 0.9));
        border-radius: 20px;
        padding: 3rem 2rem;
   text-align: center;
        box-shadow: 0 10px 40px rgba(229, 9, 20, 0.4);
        margin-bottom: 2rem;
border: 2px solid rgba(229, 9, 20, 0.5);
  }

    .genre-icon {
    font-size: 5rem;
        color: rgba(255, 255, 255, 0.9);
 margin-bottom: 1rem;
        filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.3));
    }

    .genre-title {
        font-size: 2.5rem;
    font-weight: 700;
        color: white;
        margin-bottom: 1rem;
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    }

    .genre-description {
        font-size: 1.1rem;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 1rem;
  max-width: 800px;
   margin-left: auto;
        margin-right: auto;
        line-height: 1.6;
    }

    .content-grid-card {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
 height: 100%;
        overflow: hidden;
    }

    .content-grid-card:hover {
transform: translateY(-10px) scale(1.02);
    }

    .poster-container {
     position: relative;
        height: 350px;
      overflow: hidden;
     background: linear-gradient(135deg, rgba(229, 9, 20, 0.2), rgba(255, 64, 87, 0.2));
    }

    .poster-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
     transition: all 0.4s ease;
    }

    .content-grid-card:hover .poster-image {
        transform: scale(1.1);
    }

    .poster-placeholder {
        background: linear-gradient(135deg, rgba(229, 9, 20, 0.3), rgba(255, 64, 87, 0.3));
        height: 350px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 5rem;
        color: rgba(255, 255, 255, 0.3);
    }

    .poster-overlay {
     position: absolute;
        bottom: 0;
        left: 0;
 right: 0;
        background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
   padding: 1rem;
  opacity: 0;
        transition: opacity 0.3s ease;
    }

    .content-grid-card:hover .poster-overlay {
  opacity: 1;
    }

    .type-badge {
    position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(229, 9, 20, 0.95);
        padding: 0.4rem 0.9rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      box-shadow: 0 4px 15px rgba(229, 9, 20, 0.5);
        z-index: 10;
    }

    .year-badge {
        background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(229, 9, 20, 0.4);
        padding: 0.3rem 0.8rem;
        border-radius: 15px;
 font-weight: 600;
      display: inline-block;
    }

    .card-title {
        display: -webkit-box;
  -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        min-height: 3rem;
    }
</style>

<nav class="details-breadcrumb" aria-label="breadcrumb">
    <ol class="breadcrumb mb-0">
    <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Inicio</a></li>
        <li class="breadcrumb-item"><a asp-controller="Generos" asp-action="Index">Géneros</a></li>
        <li class="breadcrumb-item active" aria-current="page">@Model.Nombre</li>
  </ol>
</nav>

<div class="genre-header">
    <i class="bi bi-tag-fill genre-icon"></i>
    <h1 class="genre-title">@Model.Nombre</h1>
    <p class="genre-description">@Model.Descripcion</p>
    <div class="d-flex justify-content-center gap-3 mt-3">
        <span class="badge bg-light text-dark fs-6">
    <i class="bi bi-film"></i> @Model.Contenidos.Count 
  @(Model.Contenidos.Count == 1 ? "contenido" : "contenidos")
        </span>
        @if (Model.Contenidos.Any())
    {
      var peliculas = Model.Contenidos.Count(c => c.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Pelicula);
            var series = Model.Contenidos.Count(c => c.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Serie);
   
            @if (peliculas > 0)
            {
       <span class="badge bg-light text-dark fs-6">
     <i class="bi bi-camera-reels"></i> @peliculas @(peliculas == 1 ? "película" : "películas")
         </span>
            }
  @if (series > 0)
      {
           <span class="badge bg-light text-dark fs-6">
     <i class="bi bi-tv"></i> @series @(series == 1 ? "serie" : "series")
     </span>
      }
        }
    </div>
</div>

@if (Model.Contenidos.Any())
{
    <div class="mb-4">
 <h3 class="display-6 fw-bold">
     <i class="bi bi-collection-play-fill text-danger"></i> Contenidos de @Model.Nombre
     </h3>
        <p class="text-muted">Explora todas las películas y series de este género</p>
    </div>
    
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
        @foreach (var contenido in Model.Contenidos.OrderByDescending(c => c.FechaEstreno))
        {
     <div class="col">
        <div class="card content-grid-card shadow-lg h-100">
              <!-- Póster o placeholder -->
    <div class="poster-container">
         @if (!string.IsNullOrEmpty(contenido.Poster))
              {
     <img src="@contenido.Poster" 
      alt="Póster de @contenido.Titulo" 
       class="poster-image"
     onerror="this.onerror=null; this.parentElement.innerHTML='<div class=\'poster-placeholder\'><i class=\'bi bi-@(contenido.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Pelicula ? "camera-reels-fill" : "tv-fill")\'></i></div>';" />
                }
  else
       {
        <div class="poster-placeholder">
          @if (contenido.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Pelicula)
          {
      <i class="bi bi-camera-reels-fill"></i>
            }
    else
      {
          <i class="bi bi-tv-fill"></i>
         }
         </div>
  }
       
        <!-- Badge de tipo -->
   <span class="type-badge">
          @if (contenido.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Pelicula)
           {
        <i class="bi bi-camera-reels"></i> <text>Película</text>
          }
       else
         {
         <i class="bi bi-tv"></i> <text>Serie</text>
     }
      </span>

         <!-- Overlay con info adicional -->
     <div class="poster-overlay">
                <small class="text-white">
              <i class="bi bi-person-badge"></i> @contenido.Director
        <br />
 <i class="bi bi-clock"></i> @contenido.Duracion min
   @if (contenido.Tipo == AE4_DWES_CarlosdeAldaGarcia.Models.TipoContenido.Serie && contenido.NumeroTemporadas.HasValue)
           {
          <text> | <i class="bi bi-collection-play"></i> @contenido.NumeroTemporadas temporadas</text>
                }
          </small>
 </div>
         </div>
      
         <div class="card-body">
   <div class="d-flex justify-content-between align-items-start mb-2">
  <span class="year-badge">
           <i class="bi bi-calendar"></i> @contenido.Anio
     </span>
   </div>

           <h5 class="card-title fw-bold mb-2" style="line-height: 1.3;">
@contenido.Titulo
    </h5>
       
       <p class="text-muted small mb-2">
   <i class="bi bi-person-fill text-info"></i> @contenido.Director
  </p>

         <p class="card-text small mb-3" style="line-height: 1.5; color: var(--text-muted);">
           @contenido.Descripcion.Substring(0, Math.Min(100, contenido.Descripcion.Length))...
      </p>
        
     @if (contenido.Valoraciones.Any())
    {
    var promedio = contenido.Valoraciones.Average(v => v.Puntuacion);
         <div class="d-flex align-items-center gap-2 mb-3">
       <span class="text-warning">
        @for (int i = 1; i <= 5; i++)
          {
            if (i <= promedio)
         {
      <i class="bi bi-star-fill"></i>
            }
        else
          {
            <i class="bi bi-star"></i>
         }
     }
            </span>
           <small class="text-muted">
    <strong>@promedio.ToString("F1")</strong>
           (@contenido.Valoraciones.Count)
    </small>
    </div>
      }
     </div>

 <div class="card-footer">
            <a asp-controller="Contenidos" asp-action="Details" asp-route-id="@contenido.Id" 
             class="btn btn-danger w-100">
          <i class="bi bi-play-circle-fill"></i> Ver Detalles
   </a>
        </div>
      </div>
        </div>
   }
    </div>
}
else
{
    <div class="text-center py-5">
  <div class="mb-4">
            <i class="bi bi-film" style="font-size: 5rem; color: var(--text-muted);"></i>
        </div>
     <h3 class="text-muted">No hay contenidos disponibles</h3>
        <p class="text-muted">Aún no se han agregado películas o series a este género.</p>
    </div>
}

<div class="mt-4">
 <a asp-action="Index" class="btn btn-outline-danger btn-lg">
        <i class="bi bi-arrow-left-circle"></i> Volver a Géneros
    </a>
</div>
